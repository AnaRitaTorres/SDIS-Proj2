
-------
18/12/2017 15:12:32
-------

DROP DATABASE IF EXISTS sdis2 
CREATE DATABASE IF NOT EXISTS sdis2 
USE sdis2 
SELECT 'CREATING DATABASE STRUCTURE' as 'INFO' 
INFO	
CREATING DATABASE STRUCTURE	
DROP TABLE IF EXISTS user 
DROP TABLE IF EXISTS groups 
DROP TABLE IF EXISTS user_group 
DROP TABLE IF EXISTS list 
DROP TABLE IF EXISTS task 
DROP TABLE IF EXISTS message 
CREATE TABLE user(
	user_id		INT				NOT NULL AUTO_INCREMENT,
	name		VARCHAR(40)		NOT NULL,
	username	VARCHAR(20)		NOT NULL,
	password	VARCHAR(30)		NOT NULL,
	PRIMARY KEY (user_id)
) 
CREATE TABLE groups(
	group_id	INT				NOT NULL AUTO_INCREMENT,
	name		VARCHAR(40)		NOT NULL,
	PRIMARY KEY (group_id)
) 
CREATE TABLE user_group(
	user_id		INT 			NOT NULL AUTO_INCREMENT,
	group_id	INT				NOT NULL,
	FOREIGN KEY (user_id)  	REFERENCES user (user_id)	ON DELETE CASCADE,
	FOREIGN KEY (group_id)	REFERENCES groups (group_id)	ON DELETE CASCADE
) 
CREATE TABLE list(
	list_id		INT				NOT NULL AUTO_INCREMENT,
	name		VARCHAR(30)		NOT NULL,
	group_id	INT				NOT NULL,
	PRIMARY KEY (list_id),
	FOREIGN KEY (group_id)  	REFERENCES groups (group_id)	ON DELETE CASCADE
) 
CREATE TABLE task(
	task_id		INT				NOT NULL AUTO_INCREMENT,
	name		VARCHAR(60)		NOT NULL,
	list_id		INT				NOT NULL,
	done		ENUM('false', 'true') NOT NULL,
	PRIMARY KEY (task_id),
	FOREIGN KEY (list_id)  	REFERENCES list (list_id)	ON DELETE CASCADE
) 
CREATE TABLE message(
	message_id 	INT 			NOT NULL AUTO_INCREMENT,
	content		VARCHAR(140)	NOT NULL,
	user_id		INT				NOT NULL,
	group_id	INT				NOT NULL,
	PRIMARY KEY (message_id),
	FOREIGN KEY (user_id)	REFERENCES user (user_id)	ON DELETE CASCADE,
	FOREIGN KEY (group_id)	REFERENCES groups (group_id)	ON DELETE CASCADE
) 
INSERT INTO user (name, username, password) VALUES
('Oscar Mike', 'omike', '12345'),
('Michelle Smith', 'mismi', 'oiblin') 
INSERT INTO groups (name) VALUES
('best coding team') 
INSERT INTO user_group (user_id, group_id) VALUES
(1, 1),
(2, 1) 
INSERT INTO list (name, group_id) VALUES
('prog proj TODO list', 1) 
INSERT INTO task (name, list_id, done) VALUES
('main method', 1, 'true'),
('client interface', 1, 'false'),
('database connection', 1, 'false'),
('REST server', 1, 'true') 
INSERT INTO message (content, user_id, group_id) VALUES
('Eu vou começar a desenvolver a client interface', 2, 1),
('OK! Eu acabei agora o server, vou começar a database connection', 1, 1) 
